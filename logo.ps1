Add-Type -AssemblyName PresentationFramework

# Define the path where the image will be saved
$path = "$env:TEMP\logo.png"

# Create a WebClient instance and download the image, overwriting if it already exists
Invoke-WebRequest -Uri "https://secureitswiss.ch/storage/Settings/1582468020_865.png" -OutFile $path

# UI Definition with XAML, correctly inserted image path variable. The Grid's background is set to Black.
$xaml = @"
<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="SecureIT Logo" Height="400" Width="600">
    <Grid Background="Black">
        <Image Source="{0}" Stretch="Uniform"/>
    </Grid>
</Window>
"@ -f $path

# Load the XAML and create the window with the correct approach
$reader = New-Object System.IO.StringReader($xaml)
$xmlReader = [System.Xml.XmlReader]::Create($reader)
$window = [Windows.Markup.XamlReader]::Load($xmlReader)

# Show the window
$window.ShowDialog()

# Optionally: Delete the downloaded image after closing the window
Remove-Item $path
